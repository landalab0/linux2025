% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{plainnat}
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Introducci√≥n a Linux para Bioinform√°tica},
  pdfauthor={LandaLab},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Introducci√≥n a Linux para Bioinform√°tica}
\author{LandaLab}
\date{2025-09-17}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\chapter{\texorpdfstring{üß™ \href{mailto:Bienvenid@s}{\nolinkurl{Bienvenid@s}}}{üß™ Bienvenid@s}}\label{bienvenids}

\textbf{Este repositorio contiene el material del taller ``Introducci√≥n a Linux'', un espacio abierto para todas las personas que quieran aprender a analizar y visualizar datos con Linux}\\
No importa tu edad, formaci√≥n o experiencia previa: si tienes curiosidad y ganas de aprender, este taller es para ti.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{üìö Sobre el taller}\label{sobre-el-taller}

\begin{itemize}
\tightlist
\item
  \textbf{Lenguaje}: Linux
\item
  \textbf{Nivel}: Principiante\\
\item
  \textbf{Modalidad}: Pr√°ctico, con ejercicios guiados y codificaci√≥n en vivo\\
\item
  \textbf{Dirigido a}: Cualquier persona interesada en aprender Linux para Bioinform√°tica\\
\item
  \textbf{Requisitos}: Ninguno. No necesitas saber programaci√≥n ni instalar ning√∫n programa. S√≥lo necesitas una computadora con acceso a internet
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{üß∞ ¬øQu√© aprender√°s?}\label{quuxe9-aprenderuxe1s}

Al finalizar el taller, podr√°s:

\begin{itemize}
\tightlist
\item
  Comunicarte con Linux a trav√©s de Shell
\item
  Manipular archivos\\
\item
  Crear proyectos
\item
  Automatizar tareas
\item
  Escribir scripts reproducibles\\
\item
  Comprender los principios b√°sicos del an√°lisis de datos en Linux
\item
  Descargar secuencias gen√≥micas
\item
  Instalar programas
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{üåê Plataforma}\label{plataforma}

Trabajaremos en una plataforma en l√≠nea, por lo que \textbf{no necesitas instalar nada en tu computadora}. El acceso ser√° gratuito y se proporcionar√° durante el taller.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{üôå Agradecimientos}\label{agradecimientos}

Este taller es parte de un esfuerzo por compartir herramientas abiertas, accesibles y colaborativas. Queremos que m√°s personas se acerquen al mundo de los datos y la ciencia sin barreras. ¬°Gracias por formar parte!

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{üí¨ ¬øDudas o comentarios?}\label{dudas-o-comentarios}

Puedes abrir un \href{https://github.com/}{Issue} o escribirnos durante el taller.\\
¬°Estamos aqu√≠ para aprender \href{mailto:junt@s}{\nolinkurl{junt@s}}!

\chapter{Introducci√≥n a Linux}\label{introducciuxf3n-a-linux}

\section{Porqu√© aprender a usar Linux y el Shell para Bioinform√°tica}\label{porquuxe9-aprender-a-usar-linux-y-el-shell-para-bioinformuxe1tica}

\section{Sistema operativo, Linux y Shell}\label{sistema-operativo-linux-y-shell}

\section{Sistema de ficheros}\label{sistema-de-ficheros}

\section{C√≥mo accedemos al Shell}\label{cuxf3mo-accedemos-al-shell}

\section{Tipos de archivos}\label{tipos-de-archivos}

\chapter{Navegar en el sistema de ficheros}\label{navegar-en-el-sistema-de-ficheros}

todo lo de este archivo hasta atajos en el teclado

\url{https://github.com/DianaOaxaca/Introduccion_linux_para_bioinformatica/blob/main/Comandos_utiles.md}

\chapter{Manejo de archivos}\label{manejo-de-archivos}

\section{C√≥digo reproducible}\label{cuxf3digo-reproducible}

\textbf{``Los sucesos √∫nicos no reproducibles, no tienen importancia para la ciencia''}
-Karl Popper, the Logic of Scientific, 1959.

¬øQu√© se necesita para reproducir el resultado de un an√°lisis computacional?

\begin{itemize}
\tightlist
\item
  \textbf{Los datos:}

  \begin{itemize}
  \tightlist
  \item
    La fuente de donde se descargaron.
  \item
    La versi√≥n de la fuente asociada a ellos.
  \end{itemize}
\item
  \textbf{Los programas utilizados para analizarlos:}

  \begin{itemize}
  \tightlist
  \item
    La versi√≥n de cada uno de los programas.
  \item
    Los valores de cada uno de los argumentos utilizados.
  \end{itemize}
\end{itemize}

\textbf{Argumentos a tener en cuenta para tener buenas pr√°cticas:}

\begin{itemize}
\tightlist
\item
  Actualizaci√≥n de bases de datos.
\item
  Siempre existir√°n excepciones que no cumplen con las suposiciones de tu c√≥digo.
\item
  \textbf{Qu√© un programa genere un resultado no significa que el resultado sea correcto.}
\item
  Todo lo que se te puede olvidar, \textbf{¬°se te va a olvidar!}

  \begin{itemize}
  \tightlist
  \item
    Fuente
  \item
    Suposiciones iniciales
  \item
    ¬øQu√© genera esa funci√≥n compleja y rebuscada que parec√≠a una joya en su momento?
  \end{itemize}
\end{itemize}

\textbf{SIEMPRE, documenta tu c√≥digo}

Comienza por la organizaci√≥n: La estructura de directorios debe estar organizada, lo mejor es
tener un directorio de trabajo por proyecto, los pasos del proyecto se organizar√°n en
subdirectorios.

La estructura de directorios propuesta para estas asesor√≠as es:

\texttt{Linux} Este es el directorio principal del proyecto.

\texttt{data} En este directorio van los datos de entrada para el proyecto.

\texttt{src} En este directorio van los scripts ya probados y funcionales.

\texttt{results} En este directorio van los resultados generados.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{Bases de datos y secuencias biol√≥gicas}\label{bases-de-datos-y-secuencias-bioluxf3gicas}

\textbf{Base de datos}: Es una colecci√≥n organizada de informaci√≥n estructurada, o datos, normalmente
almacenados electr√≥nicamente en un sistema inform√°tico.

En bioinform√°tica se utilizan diversas bases de datos, algunos ejemplos son:

De diversos organismos:

NCBI: \url{https://www.ncbi.nlm.nih.gov/}

Genomas de referencia NCBI: \url{https://ftp.ncbi.nlm.nih.gov/genomes/refseq/}

ENSEMBL: \url{https://www.ensembl.org/index.html}

UCSC Table Browser: \url{https://genome.ucsc.edu/cgi-bin/hgTables}

Dedicadas a organismos espec√≠ficos:

Ecocyc

Flybase

Wormbase

Especializadas en un tema particular:

\textbf{ENCODE:} Elementos funcionales del genoma humano

\textbf{RegulonDB:} Regulaci√≥n transcripcional de E. coli

\textbf{Pfam:} Familias prote√≠cas

\textbf{miRBase:} Secuencias de miRNA y sus blancos

\textbf{Secuencias biol√≥gicas}: Archivo que contiene la secuencia de genes, genomas y/o prote√≠nas.

\textbf{Fasta}: Se compone de un identificador de la secuencia, seguido (por salto de l√≠nea) de la
secuencia de nucle√≥tidos o amino√°cidos de un gene, genoma o prote√≠na.

\textbf{Fastq}: Normalmente se conmpone de cuatro lineas por secuencia

\texttt{Line\ 1} Comienza con `@' seguido del identificador de la secuencia y una descripci√≥n opcional.

\texttt{Line\ 2} La secuencia cruda nucle√≥tidos.

\texttt{Line\ 3} Comienza con un `+' opcionalmente incluye el identificador de la secuencia.

\texttt{Line\ 4} Indica los valores de calidad de la secuencia, debe contener el mismo n√∫mero de s√≠mbolos que el n√∫mero de nucle√≥tidos.

\textbf{De anotaci√≥n}: GeneBank o tabulares GFF, GTF, GFF3

\textbf{Tabulares:} Una l√≠nea por cada elemento. Cada l√≠nea DEBE contener 9 campos. Los campos DEBEN estar separados por tabuladores. Todos los campos DEBEN contener un valor, los campos vac√≠os se denotan con '.'

\texttt{seqname} Nombre del cromosoma

\texttt{source} Nombre del programa que gener√≥ ese elemento

\texttt{feature} Tipo de elemento

\texttt{start} Posici√≥n de inicio

\texttt{end} Posici√≥n de final

\texttt{score} Un valor de punto flotante

\texttt{strand} La cadena (+ , - )

\texttt{frame} Marco de lectura

\texttt{attribute} Pares tag-value, separados por coma, que proveen informaci√≥n
adicional

\textbf{Secuencia FASTA}

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{\textgreater{}}\NormalTok{ID\_secuencia,metadatos }\ExtensionTok{de}\NormalTok{ identificaci√≥n}
\ExtensionTok{ATGCCCGGTAAAGGATCCCCCCTATGCCGTATAGC}
\OperatorTok{\textgreater{}}\NormalTok{ID\_secuencia,metadatos }\ExtensionTok{de}\NormalTok{ identificaci√≥n}
\ExtensionTok{MIPEKRIIRRIQSGGCAIHCQDCSISQLCIPFTLNEHELDQLDNI}
\end{Highlighting}
\end{Shaded}

\textbf{Secuencia Fastq }

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{@SEQ\_ID}
\ExtensionTok{GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT}
\ExtensionTok{+}
\ExtensionTok{!}\StringTok{\textquotesingle{}\textquotesingle{}}\ExtensionTok{*}\ErrorTok{((}\NormalTok{((}\OperatorTok{***+}\NormalTok{))}\OperatorTok{\%\%\%++}\KeywordTok{)(}\ExtensionTok{\%\%\%\%}\KeywordTok{)}\ExtensionTok{.1***{-}+*}\StringTok{\textquotesingle{}\textquotesingle{}}\KeywordTok{)}\ErrorTok{)}\ExtensionTok{**55CCF}\OperatorTok{\textgreater{}\textgreater{}\textgreater{}\textgreater{}\textgreater{}\textgreater{}}\NormalTok{CCCCCCC65}
\end{Highlighting}
\end{Shaded}

Agunos foros para pedir ayuda:

\textbf{Stackoverflow:} \url{https://stackoverflow.com/}

\textbf{Biostars:} \url{https://www.biostars.org/}

\textbf{Researchgate:} \url{https://www.researchgate.net/}

\textbf{IAs}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{Manejo de archivos}\label{manejo-de-archivos-1}

\textbf{wget, curl, shasum, md5sum, diff, scp, rsync, gunzip, unzip, tar, head, tail, more, less, cat, \textgreater, \textgreater\textgreater, nano}

Link para el genoma de Raoultella terrigena:

\url{https://ftp.ncbi.nlm.nih.gov/genomes/refseq/bacteria/Raoultella_terrigena/reference/GCF_012029655.1_ASM1202965v1/}

Para descargar archivos a nuestra computadora desde la terminal, se requiere utilizar protocolos de transferencia, los comandos \texttt{wget} o \texttt{curl} funcionan para ello. Ve√°mos un ejemplo:

\begin{itemize}
\item
  Crea el directorio principal de trabajo para este proyecto y sus subdirectorios asociados.
\item
  Accede al directorio data
\item
  Descarga el genoma representativo de Raoultella terrigena de la Refseq de NCBI
\item
  Ahora descarga las secuencias prote√≠cas
\end{itemize}

¬øNotaste alg√∫n cambio?
- Vuelve a descargar el genoma de Raoultella terrigena, pero ahora aseg√∫rate de guardar la secuencia en un archivo llamado Raoultella\_terrigena.fasta.gz

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{wget}\NormalTok{ https://ftp.ncbi.nlm.nih.gov/genomes/refseq/bacteria/Raoultella\_terrigena/reference/GCF\_012029655.1\_ASM1202965v1/GCF\_012029655.1\_ASM1202965v1\_genomic.fna.gz}
\end{Highlighting}
\end{Shaded}

Descarga el archivo de amino√°cidos de Raoultella terrigena con el nombre \texttt{Raoultella\_terrigena.faa.gz}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{wget} \AttributeTok{{-}O}\NormalTok{ Raoultella\_terrigena.faa.gz https://ftp.ncbi.nlm.nih.gov/genomes/refseq/bacteria/Raoultella\_terrigena/reference/GCF\_012029655.1\_ASM1202965v1/GCF\_012029655.1\_ASM1202965v1\_protein.faa.gz}
\end{Highlighting}
\end{Shaded}

¬øQu√© ocurri√≥?

\texttt{curl} Realiza la misma funci√≥n b√°sica que wget , las diferencias principales son: El output lo imprime a standar output, imprime varias estad√≠sticas √∫tiles sobre la descarga.

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{curl}\NormalTok{ https://ftp.ncbi.nlm.nih.gov/genomes/refseq/bacteria/Raoultella\_terrigena/reference/GCF\_012029655.1\_ASM1202965v1/GCF\_012029655.1\_ASM1202965v1\_protein.faa.gz}
\end{Highlighting}
\end{Shaded}

Con \texttt{curl}

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{curl}
\ExtensionTok{https://ftp.ncbi.nlm.nih.gov/genomes/refseq/bacteria/Raoultella\_terrigena/reference/GCF\_012029655.1\_ASM1202965v1/GCF\_012029655.1\_ASM1202965v1\_protein.faa.gz} \OperatorTok{\textgreater{}}\NormalTok{ Raoultella\_terrigena2.faa.gz}
\end{Highlighting}
\end{Shaded}

¬øC√≥mo comprobamos que dos archivos son id√©nticos? Hemos descargado dos veces la secuencia gen√≥mica de \emph{Raoultella terrigena}. Comprobemos que ambos archivos son id√©nticos.

Prueba con \texttt{diff\ -s}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{diff}\NormalTok{ GCF\_012029655.1\_ASM1202965v1\_genomic.fna.gz Raoultella\_terrigena.fasta.gz}
\end{Highlighting}
\end{Shaded}

¬øY si comparas el faa vs fasta?

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{diff}\NormalTok{ ../data/Raoultella\_terrigena.faa.gz ../data/Raoultella\_terrigena.fasta.gz}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{Redireccionamientos y evaluaci√≥n de la integridad}\label{redireccionamientos-y-evaluaciuxf3n-de-la-integridad}

\textbf{\texttt{\textgreater{}}} Permite direccionar un resultado a un archivo nuevo. Crea el archivo si no existe y lo sobre escribe si existe.

\textbf{\texttt{\textgreater{}\textgreater{}}} Permite redireccionar un resultado en pantalla o un archivo a otro, sin remplazar o sobreescribir. Crea el archivo si no existe y agrega el nuevo contenido al final, si el archivo existe.

\textbf{\texttt{shasum}} y \textbf{\texttt{md5sum}} son programas que generan una suma encriptada √∫nica para cada
archivo.

Revisemos la integridad de los archivos, descarga el archivo md5checksums.txt del directorio genomes/refseq/bacteria/Raoultella terigena de NCBI

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{curl}\NormalTok{ https://ftp.ncbi.nlm.nih.gov/genomes/refseq/bacteria/Raoultella\_terrigena/reference/GCF\_012029655.1\_ASM1202965v1/md5checksums.txt }\OperatorTok{\textgreater{}}
\ExtensionTok{md5sum\_R.terrigena.txt}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{shasum}\NormalTok{ Raoultella\_terrigena.fasta.gz}
\FunctionTok{md5sum}\NormalTok{ Raoultella\_terrigena.fasta.gz}
\FunctionTok{cat}\NormalTok{ md5sum\_R.terrigena.txt}
\end{Highlighting}
\end{Shaded}

Redireccionemos los resultados de integridad a un archivo nuevo.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{md5sum}\NormalTok{ Raoultella\_terrigena.fasta.gz }\OperatorTok{\textgreater{}}
\ExtensionTok{../resuts/R.terrigena.md5sum.check}

\FunctionTok{cat}\NormalTok{ ../results/R.terrigena.msd5sum.check}
\FunctionTok{cat}\NormalTok{ md5sum\_R.terrigena.txt }\OperatorTok{\textgreater{}\textgreater{}}\NormalTok{ ../results/R.terrigena.md5sum.check}
\FunctionTok{cat}\NormalTok{ ../results/R.terrigena.msd5sum.check}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{Transferencia de archivos}\label{transferencia-de-archivos}

Esta parte no la vamos a practicar porque estamos usando una interfaz gr√°fica con acceso al servidor, pero si no tienes esta forma de acceso es necesario usar estos comandos, asi que te dejamos el ejemplo. :)

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{\textasciigrave{}}\FunctionTok{scp}\KeywordTok{\textasciigrave{}} \PreprocessorTok{[}\SpecialStringTok{FUENTE}\PreprocessorTok{][}\SpecialStringTok{DESTINO}\PreprocessorTok{]}
\CommentTok{\#FUENTE=Nombre del archivo que quieres transferir}
\CommentTok{\#DESTINO=Ruta de destino}
\CommentTok{\#Ejemplo de mi computadora al servidor:}
\FunctionTok{scp}\NormalTok{ md5sum\_R.terrigena.txt hoaxaca@132.248.220.35:/space31/PEG/hoaxaca}
\CommentTok{\#Me pedir√° el password}
\CommentTok{\#Funciona de manera inversa si quieres bajar del servidor a tu computadora}
\FunctionTok{scp}\NormalTok{ hoaxaca@132.248.220.35:/space31/PEG/hoaxaca/md5sum\_R.terrigena.txt .\#ojo el}
\ExtensionTok{destino}\NormalTok{ puede ser con ruta absoluta o relativa, aqu√≠ fue relativa }\StringTok{"."}
\CommentTok{\#Tambi√©n puedes usar rsync}
\KeywordTok{\textasciigrave{}}\FunctionTok{rsync} \AttributeTok{{-}e}\NormalTok{ ssh}\KeywordTok{\textasciigrave{}} \PreprocessorTok{[}\SpecialStringTok{FUENTE}\PreprocessorTok{][}\SpecialStringTok{DESTINO}\PreprocessorTok{]}
\CommentTok{\# {-}e ssh indica que nos conectaremos al servidor a trav√©s de una conexi√≥n de}
\ExtensionTok{tipo}\NormalTok{ ssh}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{Compresi√≥n y descompresi√≥n}\label{compresiuxf3n-y-descompresiuxf3n}

Para descomprimir archivos usamos \textbf{\texttt{gunzip}}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{gunzip}\NormalTok{ Raoultella\_terrigena.fasta.gz}
\FunctionTok{gunzip} \PreprocessorTok{*}\NormalTok{.gz}
\end{Highlighting}
\end{Shaded}

Para comprimir usamos \textbf{\texttt{gzip}}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{gzip} \PreprocessorTok{*}\NormalTok{.f}\PreprocessorTok{*}
\end{Highlighting}
\end{Shaded}

¬øY si quiero comprimir directorios? Para ello utilizo tar que es un m√©todo de ultra
compresi√≥n, muy utilizada en datos gen√≥micos. Vamos a comprimir el directorio practica1

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{cd}\NormalTok{ ../../}
\FunctionTok{tar}\NormalTok{ cvzf practica1.tar.gz practica1/}
\CommentTok{\# c = crea un nuevo directorio}
\CommentTok{\# v = muestra el progreso dde la compresi√≥n}
\CommentTok{\# z = genera un archivo comprimido en zip (.gz)}
\CommentTok{\# f = para indicar el nombre del archivo comprimido}
\end{Highlighting}
\end{Shaded}

Y para descomprimir?

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rm} \AttributeTok{{-}r}\NormalTok{ practica1/}
\FunctionTok{tar} \AttributeTok{{-}xvf}\NormalTok{ practica1.tar.gz}
\CommentTok{\# ¬øqu√© hace el flag x?}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{Explorar archivos}\label{explorar-archivos}

Veamos las primeras l√≠neas del archivo de anotaci√≥n .gtf del genoma de Raoultella terrigena

¬øY, cu√°l es ese, lo tenemos?

Vamos a descargarlo

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{wget} \AttributeTok{{-}O}\NormalTok{ Raoultella\_terrigena.gtf.gz}
\ExtensionTok{https://ftp.ncbi.nlm.nih.gov/genomes/refseq/bacteria/Raoultella\_terrigena/reference/GCF\_012029655.1\_ASM1202965v1/GCF\_012029655.1\_ASM1202965v1\_genomic.gtf.gz}
\end{Highlighting}
\end{Shaded}

Luego a descomprimirlo

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{gunzip}\NormalTok{ Raoultella\_terrigena.gtf.gz}
\end{Highlighting}
\end{Shaded}

Ahora si

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{ Raoultella\_terrigena.gtf}
\end{Highlighting}
\end{Shaded}

¬øY si quiero ver las primeras 20 lineas?

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head} \AttributeTok{{-}n}\NormalTok{ 20 Raoultella\_terrigena.gtf}
\end{Highlighting}
\end{Shaded}

Ahora quiero ver las √∫ltimas l√≠neas de un archivo

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{tail}\NormalTok{ Raoultella\_terrigena.gtf}
\end{Highlighting}
\end{Shaded}

Veamos el genoma

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{more}\NormalTok{ Raoultella\_terrigena.fasta}
\CommentTok{\# Enter =\textgreater{} Navegar hacia abajo de l√≠nea en l√≠nea}
\CommentTok{\# Espacio =\textgreater{} Navega hacia abajo de pantalla en pantalla}
\end{Highlighting}
\end{Shaded}

Pero podemos ver archivos con algo m√°s potente

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{less}\NormalTok{ Raoultella\_terrigena.gtf}
\end{Highlighting}
\end{Shaded}

\textbf{\texttt{Espacio\ OR\ Enter}} =\textgreater{} Navegar hacia abajo

\textbf{\texttt{b\ OR\ flecha\ arriba}} =\textgreater{} Navegar hacia arriba

\textbf{\texttt{/WORD}} =\textgreater{} B√∫squeda forward

\textbf{\texttt{n}} =\textgreater{} Siguiente

\textbf{\texttt{?WORD}} =\textgreater{} B√∫squeda backward

\textbf{\texttt{N}} =\textgreater{} Anterior

\textbf{\texttt{G}} =\textgreater{} Ir al final del archivo

\textbf{\texttt{g}} =\textgreater{} Ir al inicio del archivo

\textbf{\texttt{-S}} =\textgreater{} Mostrar una l√≠nea por rengl√≥n

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{Ejercicio 02}\label{ejercicio-02}

Est√°s realizando tu proyecto con Raoultella terrigena y tu directora de tesis te pregunta si hay genes nitrogenasa ubicados en la posici√≥n 501417 o 3010433 del genoma representativo de los genomas de referencia de esta especie. T√∫ debes responderle si est√°n o no en esa posici√≥n, y si no est√°n, avisarle en qu√© posici√≥n se encuentran y cu√°ntos son.

\textbf{Pseudoc√≥digo} Es la manera en la que planeas, dise√±as la ruta de trabajo que usar√°s para responder una pregunta. Es el dise√±o experimental.

Pseudoc√≥digo:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Crea el directorio sesion02 dentro del directorio results
\item
  Descarga el archivo de anotaci√≥n .gff de Raoultella terrigena en el directorio correspondiente.
\item
  Revisa su integridad y redirecciona el resultado al directorio correspondiente
\item
  Descomprime el archivo de anotaci√≥n
\item
  Navega al final del archivo
\item
  Navega al inicio del archivo
\item
  Busca el gene que inicie en la posici√≥n 501417
\item
  Busca el CDS que termine en la posici√≥n 3010433
\item
  Busca los genes nitrogenasa
\item
  Escribe los resultados
\end{enumerate}

\chapter{Filtrar informaci√≥n}\label{filtrar-informaciuxf3n}

En esta sesi√≥n, exploraremos los comandos \texttt{\textbar{}}, \texttt{sort}, \texttt{cut}, \texttt{uniq}, \texttt{wc} y \texttt{grep} para analizar el genoma de \emph{Raoultella terrigena}. Estos comandos son esenciales para procesar datos en la terminal de manera eficiente.

\section{Recordatorio: Comandos B√°sicos}\label{recordatorio-comandos-buxe1sicos}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Lista los contenidos del directorio ra√≠z y busca si existe un directorio llamado \texttt{home} usando \texttt{less}:
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ls}\NormalTok{ /}
\FunctionTok{ls}\NormalTok{ / }\KeywordTok{|} \FunctionTok{less}
\CommentTok{\# Resultado esperado: /home}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Lista los primeros 10 archivos del directorio ra√≠z:
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ls}\NormalTok{ / }\KeywordTok{|} \FunctionTok{head} \AttributeTok{{-}10}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Lista los √∫ltimos 5 archivos del directorio ra√≠z:
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ls}\NormalTok{ / }\KeywordTok{|} \FunctionTok{tail} \AttributeTok{{-}5}
\end{Highlighting}
\end{Shaded}

\section{Introducci√≥n a los Comandos}\label{introducciuxf3n-a-los-comandos}

\begin{itemize}
\item
  \textbf{Pipe (\texttt{\textbar{}})}: Permite conectar la salida de un programa con la entrada de otro, procesando datos en RAM para mayor rapidez, evitando escritura/lectura en disco. A diferencia de \texttt{\&\&}, que ejecuta comandos independientes, \texttt{\textbar{}} requiere que la salida de un comando sea la entrada del siguiente.
\item
  \textbf{sort}: Ordena l√≠neas de texto.
\item
  \textbf{cut}: Extrae secciones de cada l√≠nea.
\item
  \textbf{uniq}: Filtra l√≠neas repetidas (requiere que el archivo est√© ordenado).
\item
  \textbf{wc}: Cuenta l√≠neas, palabras, caracteres o bytes.
\item
  \textbf{grep}: Busca patrones en archivos.
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Estructura de un Archivo de Anotaci√≥n (GFF)}

Un archivo GFF tiene las siguientes columnas:

\textbf{seqname:} Nombre del cromosoma.

\textbf{source:} Programa que gener√≥ el elemento.

\textbf{feature:} Tipo de elemento (e.g., gene, CDS).

\textbf{start:} Posici√≥n de inicio.

\textbf{end:} Posici√≥n de final.

\textbf{score:} Valor de punto flotante.

\textbf{strand:} Cadena (+, -).

\textbf{frame:} Marco de lectura.

\textbf{attribute:} Pares tag-value con informaci√≥n adicional.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{Features en el Genoma}\label{features-en-el-genoma}

\textbf{Tama√±o del Genoma de Raoultella terrigena}

¬øQu√© archivo necesitamos?

El archivo Raoultella\_terrigena.fasta.

¬øQu√© comando nos ayuda?

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{wc}\NormalTok{ data/Raoultella\_terrigena.fasta}
\end{Highlighting}
\end{Shaded}

Nota: Este comando da una estimaci√≥n aproximada, ya que incluye bytes del encabezado y saltos de l√≠nea.

Guarda los resultados en un archivo:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mkdir} \AttributeTok{{-}p}\NormalTok{ results/sesion3}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{echo} \StringTok{\textquotesingle{}El genoma de Raoultella puede medir:\textquotesingle{}} \OperatorTok{\textgreater{}}\NormalTok{ results/sesion3/Raoultella\_caracteristicas.txt}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{wc}\NormalTok{ data/Raoultella\_terrigena.fasta }\OperatorTok{\textgreater{}\textgreater{}}\NormalTok{ results/sesion3/Raoultella\_caracteristicas.txt}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{N√∫mero de Cromosomas}

\textbf{¬øQu√© archivo necesitamos?}

El archivo Raoultella\_terrigena.gff.

\textbf{¬øQu√© comando nos ayuda?}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cut} \AttributeTok{{-}f1}\NormalTok{ data/Raoultella\_terrigena.gff }\KeywordTok{|} \FunctionTok{head}
\end{Highlighting}
\end{Shaded}

Nota: El resultado incluye las 8 l√≠neas del encabezado. Para excluirlas:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{grep} \AttributeTok{{-}v} \StringTok{"\#"}\NormalTok{ data/Raoultella\_terrigena.gff }\KeywordTok{|} \FunctionTok{cut} \AttributeTok{{-}f1} \KeywordTok{|} \FunctionTok{sort} \KeywordTok{|} \FunctionTok{uniq}
\end{Highlighting}
\end{Shaded}

Guarda el resultado

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{echo} \StringTok{\textquotesingle{}El genoma de Raoultella tiene un cromosoma y es\textquotesingle{}} \OperatorTok{\textgreater{}\textgreater{}}\NormalTok{ results/sesion3/Raoultella\_caracteristicas.txt}
\FunctionTok{grep} \AttributeTok{{-}v} \StringTok{"\#"}\NormalTok{ data/Raoultella\_terrigena.gff }\KeywordTok{|} \FunctionTok{cut} \AttributeTok{{-}f1} \KeywordTok{|} \FunctionTok{uniq} \OperatorTok{\textgreater{}\textgreater{}}\NormalTok{ results/sesion3/Raoultella\_caracteristicas.txt}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{N√∫mero de features}

\textbf{¬øQu√© archivo necesitamos?}

El archivo Raoultella\_terrigena.gff.

\textbf{¬øQu√© comandos requerimos?}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cut} \AttributeTok{{-}f3}\NormalTok{ data/Raoultella\_terrigena.gff }\KeywordTok{|} \FunctionTok{uniq}
\end{Highlighting}
\end{Shaded}

\textbf{Nota:} uniq requiere que las l√≠neas est√©n ordenadas. Prueba:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cut} \AttributeTok{{-}f3}\NormalTok{ data/Raoultella\_terrigena.gff }\KeywordTok{|} \FunctionTok{sort} \KeywordTok{|} \FunctionTok{uniq}
\CommentTok{\# Alternativa:}
\FunctionTok{cut} \AttributeTok{{-}f3}\NormalTok{ data/Raoultella\_terrigena.gff }\KeywordTok{|} \FunctionTok{sort} \AttributeTok{{-}u}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{N√∫mero de tipos de features}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cut} \AttributeTok{{-}f3}\NormalTok{ data/Raoultella\_terrigena.gff }\KeywordTok{|} \FunctionTok{sort} \AttributeTok{{-}u} \KeywordTok{|} \FunctionTok{wc} \AttributeTok{{-}l}
\end{Highlighting}
\end{Shaded}

Quita las lineas comentadas

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Fuentes de los datos de anotaci√≥n}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cut} \AttributeTok{{-}f2}\NormalTok{ data/Raoultella\_terrigena.gff }\KeywordTok{|} \FunctionTok{sort} \AttributeTok{{-}u}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

N√∫mero de genes y CDS

\textbf{Pseudoc√≥digo}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Acceder a la columna 3 (feature).
\item
  Contar ocurrencias √∫nicas de cada elemento.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cut} \AttributeTok{{-}f3}\NormalTok{ data/Raoultella\_terrigena.gff }\KeywordTok{|} \FunctionTok{sort} \KeywordTok{|} \FunctionTok{uniq} \AttributeTok{{-}c}
\end{Highlighting}
\end{Shaded}

Para evitar contar elementos repetidos:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cut} \AttributeTok{{-}f3{-}5}\NormalTok{ data/Raoultella\_terrigena.gff }\KeywordTok{|} \FunctionTok{sort} \AttributeTok{{-}u} \KeywordTok{|} \FunctionTok{cut} \AttributeTok{{-}f1} \KeywordTok{|} \FunctionTok{sort} \KeywordTok{|} \FunctionTok{uniq} \AttributeTok{{-}c}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Genes por cadena}

\textbf{Pseudoc√≥digo}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Cortar las columnas feature y strand.
\item
  Ordenar y contar ocurrencias √∫nicas.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cut} \AttributeTok{{-}f3,7}\NormalTok{ data/Raoultella\_terrigena.gff }\KeywordTok{|} \FunctionTok{sort} \KeywordTok{|} \FunctionTok{uniq} \AttributeTok{{-}c}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

Crea un archivo de anotaci√≥n ordenado por cadena y por regi√≥n gen√≥mica

\textbf{Pseudoc√≥digo}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Acceder a las columnas de cadena (strand) y posiciones gen√≥micas.
\item
  Ordenar por cadena y luego por posici√≥n (num√©ricamente).
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sort} \AttributeTok{{-}k7,7} \AttributeTok{{-}k4,4n}\NormalTok{ data/Raoultella\_terrigena.gff }\OperatorTok{\textgreater{}}\NormalTok{ results/R\_terrigena\_strand.gff}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Cu√°ntos genes hay con diferente nombre?}

\textbf{Pseudoc√≥digo}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Filtrar registros de tipo gene.
\item
  Acceder a la columna 9 (atributos).
\item
  Separar por ; y extraer nombres.
\item
  Contar valores √∫nicos.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{grep} \AttributeTok{{-}P} \StringTok{"\textbackslash{}tgene\textbackslash{}t"}\NormalTok{ data/Raoultella\_terrigena.gff }\KeywordTok{|} \FunctionTok{cut} \AttributeTok{{-}f9} \KeywordTok{|} \FunctionTok{cut} \AttributeTok{{-}d} \StringTok{\textquotesingle{};\textquotesingle{}} \AttributeTok{{-}f3} \KeywordTok{|} \FunctionTok{sort} \AttributeTok{{-}u} \KeywordTok{|} \FunctionTok{wc} \AttributeTok{{-}l}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{Ejercicios}\label{ejercicios}

\begin{itemize}
\item
  \textbf{1. Cu√°ntos genes hay con distinto ID?}

  \textbf{Pseudoc√≥digo}

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    Filtrar registros de tipo gene.
  \item
    Acceder a la columna 9.
  \item
    Separar por ; y =, qued√°ndote con el ID.
  \item
    Contar valores √∫nicos.
  \end{enumerate}
\item
  \textbf{2. Cu√°ntas secuencias prote√≠cas?}

  Tip: usa el archivo de proteinas
\item
  \textbf{3. Cu√°nto mide la secuencia de la prote√≠na WP\_000448832.1?}

  \textbf{Pseudoc√≥digo}

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \item
    Localizar el ID \texttt{WP\_000448832.1}.
  \item
    Extraer la secuencia y contar caracteres.
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \setcounter{enumi}{3}
  \tightlist
  \item
    Cu√°l es el ID del gene \texttt{fnr}
  \end{enumerate}
\end{itemize}

\chapter{Obtener m√°s informaci√≥n}\label{obtener-muxe1s-informaciuxf3n}

En esta sesi√≥n, exploraremos los comandos \texttt{sed}, \texttt{tr} y ciclos \texttt{for}. Adem√°s aprenderemos a crear ambientes de conda e instalar programas dentro de este.

\section{Descargar secuencias fastq}\label{descargar-secuencias-fastq}

\subsection{Subir archivos al servidor}\label{subir-archivos-al-servidor}

Trabajaremos con datos de amplicones de la regi√≥n V3-V4 del 16S rRNA de muestras tres tiempos de fermentaci√≥n del pulque, estos se obtuvieron con una plataforma ILLUMINA MiSeq (2 x 300 pb) y est√°n en formato FASTQ. Los datos fueron depositados en NCBI y ENA bajo el BioProject \textbf{PRJEB13870} del art√≠culo \textbf{\href{https://www.sciencedirect.com/science/article/pii/S0944501320304614\#sec0010}{Deep microbial community profiling along the fermentation process of pulque, a biocultural resource of Mexico}}.

Vamos a descargar el reporte del BioProject para obtener las ligas de descarga de cada librer√≠a, \textbf{asegurate de que el nombre del experimento este marcado en las casillas}, descarguemos el archivo tsv del reporte que se encuentra en la siguiente liga:

\url{https://www.ebi.ac.uk/ena/browser/view/PRJNA556980}

Ve a la terminal de tu computadora y sit√∫ate en el directorio en donde se descarg√≥ el reporte.

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{cd}\NormalTok{ \textasciitilde{}/Downloads/}
\FunctionTok{ls}\NormalTok{ \textasciitilde{}/Downloads/reporte.txt}
\end{Highlighting}
\end{Shaded}

El reporte que descargamos nos servir√° para obtener los archivos \textbf{fastq} de cada librer√≠a secuenciada, pero necesitamos tenerlos en el servidor y no en nuestra m√°quina local. As√≠ que vamos a subir el reporte al servidor.

Con \textbf{\texttt{scp}} podemos hacer copias de la computadora al servidor y visceversa.

Sit√∫ate en la terminal de tu m√°quina local, justo en el directorio donde se encuentra el archivo que acabamos de descargar:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Para subir archivos}
\FunctionTok{scp} \AttributeTok{{-}P}\NormalTok{ 7915 reporte.txt }\PreprocessorTok{[}\SpecialStringTok{USUARIO}\PreprocessorTok{]}\NormalTok{@IP:/ruta/data}

\CommentTok{\#Para descargar archivos}
\CommentTok{\#scp {-}P 7915 [USUARIO]@132.248.15.30:/botete/[USUARIO]/amplicones/data/[archivo] .}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{Filtrar s√≥lo la informaci√≥n √∫til}\label{filtrar-suxf3lo-la-informaciuxf3n-uxfatil}

\begin{itemize}
\tightlist
\item[$\boxtimes$]
  Ahora regresa a la terminal del servidor y lista el contenido del directorio \texttt{data}
\end{itemize}

Podemos ver que el reporte se aloja en este directorio.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{less} \AttributeTok{{-}S}\NormalTok{ reporte.txt}
\end{Highlighting}
\end{Shaded}

Podemos notar que contiene la informaci√≥n de todas las librer√≠as que se secuenciaron en el proyecto, sin embargo, a nosotros s√≥lo nos interesan los que son de amplicones del 16S rRNA. As√≠ que nos quedaremos s√≥lo con esta informaci√≥n.

¬øCu√°ntas de estas corresponden a its?

\begin{quote}
\begin{itemize}
\tightlist
\item[$\boxtimes$]
  Averigua en la ayuda de grep que hacen las banderas \texttt{-\/-color} \texttt{-c} \texttt{-v}
\end{itemize}
\end{quote}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{grep} \AttributeTok{{-}{-}color} \StringTok{\textquotesingle{}its\textquotesingle{}}\NormalTok{ data/reporte.txt}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{grep} \AttributeTok{{-}c} \StringTok{\textquotesingle{}its\textquotesingle{}}\NormalTok{ data/reporte.txt}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{grep} \AttributeTok{{-}v} \StringTok{\textquotesingle{}its\textquotesingle{}}\NormalTok{ data/reporte.txt}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{grep} \AttributeTok{{-}c} \AttributeTok{{-}v} \StringTok{\textquotesingle{}its\textquotesingle{}}\NormalTok{ data/reporte.txt}
\end{Highlighting}
\end{Shaded}

La informaci√≥n que necesitamos para descargar los fastq son: el nombre de la muestra y la liga de descarga. Esta informaci√≥n se encuentra en las columnas \texttt{experiment\_title} y \texttt{fastq\_ftp}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cut} \AttributeTok{{-}f3,6}\NormalTok{ reporte.txt}
\end{Highlighting}
\end{Shaded}

Recordemos especificar el delimitador de las columnas usando la bandera \texttt{-d}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cut} \AttributeTok{{-}f3,6}\NormalTok{ reporte.txt}\KeywordTok{|} \FunctionTok{cut} \AttributeTok{{-}d}\StringTok{\textquotesingle{} \textquotesingle{}} \AttributeTok{{-}f4{-}7} \KeywordTok{|} \FunctionTok{grep} \AttributeTok{{-}v} \StringTok{\textquotesingle{}its\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

:o Ahora si contiene s√≥lo la informaci√≥n de las librer√≠as del 16S, sin embargo a√∫n nos falta un poco\ldots{}
Si recordamos, cada librer√≠a est√° pareada, si notamos el contenido de la columna 2 veremos que hay dos ligas de descarga separadas por un \texttt{;} as√≠ que necesitamos obtener cada liga por separado.

\textbf{\texttt{sed}} nos ayuda a sustituir patrones de texto o caracteres.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{ data/reporte.txt  }\KeywordTok{|} \FunctionTok{grep} \AttributeTok{{-}v} \StringTok{\textquotesingle{}its\textquotesingle{}} \KeywordTok{|}  \FunctionTok{grep} \AttributeTok{{-}v} \StringTok{\textquotesingle{}fastq\_ftp\textquotesingle{}} \KeywordTok{|} \FunctionTok{cut} \AttributeTok{{-}f5} \KeywordTok{|} \FunctionTok{sed} \StringTok{\textquotesingle{}s/;/\textbackslash{}n/g\textquotesingle{}} \KeywordTok{|} \FunctionTok{less} \AttributeTok{{-}S}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\subsection{Obtener las secuencias}\label{obtener-las-secuencias}

Recordemos que \textbf{\texttt{wget}} permite descargar archivos de la web al servidor o a la m√°quina local.

Pero como son varios los archivos que necesitamos, haremos un \emph{ciclo for} que nos ayude a optimizar esta tarea.

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ fq }\KeywordTok{in} \VariableTok{$(}\FunctionTok{cut} \AttributeTok{{-}f2}\NormalTok{ data/reporte\_16S.txt}\VariableTok{)}\KeywordTok{;} \ControlFlowTok{do} \FunctionTok{wget} \VariableTok{$fq}\NormalTok{ data/}\KeywordTok{;} \ControlFlowTok{done}
\end{Highlighting}
\end{Shaded}

Lista el contenido de tu directorio data, ¬øqu√© contiene?

\subsection{Verificar la integridad de las secuencias}\label{verificar-la-integridad-de-las-secuencias}

Obtengamos el identificador md5 desde el reporte de los datos

Con \textbf{\texttt{tr}} podemos cambiar car√°cteres:

\begin{itemize}
\tightlist
\item
  Traducir un caracter a otro
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{echo "este es un ejemplo" | tr \textquotesingle{}e\textquotesingle{} \textquotesingle{}a\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Podemos especificar rangos de caracteres
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{echo "este es un ejemplo" | tr a{-}z A{-}Z }
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  O clases de caracteres
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{echo} \StringTok{"este es un ejemplo"} \KeywordTok{|} \FunctionTok{tr} \PreprocessorTok{[}\SpecialStringTok{:lower:}\PreprocessorTok{]} \PreprocessorTok{[}\SpecialStringTok{:upper:}\PreprocessorTok{]} 
\end{Highlighting}
\end{Shaded}

Veamos \ldots{}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cut} \AttributeTok{{-}f3,5}\NormalTok{ reporte.txt }\KeywordTok{|} \FunctionTok{cut} \AttributeTok{{-}d}\StringTok{\textquotesingle{} \textquotesingle{}} \AttributeTok{{-}f4{-}7} \KeywordTok{|} \FunctionTok{grep} \AttributeTok{{-}v} \StringTok{\textquotesingle{}its\textquotesingle{}} \KeywordTok{|} \ExtensionTok{tr}\StringTok{\textquotesingle{};\textquotesingle{}} \StringTok{\textquotesingle{}\textbackslash{}n\textquotesingle{}} \KeywordTok{|} \FunctionTok{grep} \AttributeTok{{-}v} \StringTok{\textquotesingle{}experiment\textquotesingle{}} \KeywordTok{|} \FunctionTok{cut} \AttributeTok{{-}f2}
\end{Highlighting}
\end{Shaded}

Ahora generemos el identificador de los datos que ya descargamos

Entra al directorio data

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{md5sum}\NormalTok{ SRR9849602\_1.fastq.gz}
\end{Highlighting}
\end{Shaded}

Pero otra vez son muchos, hagamos un ciclo for para esto:

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ gz }\KeywordTok{in} \VariableTok{$(}\FunctionTok{ls} \PreprocessorTok{*}\NormalTok{.gz}\VariableTok{)}\KeywordTok{;} \ControlFlowTok{do} \FunctionTok{md5sum} \VariableTok{$gz} \KeywordTok{;} \ControlFlowTok{done}
\end{Highlighting}
\end{Shaded}

\textbf{Nota:} Tambi√©n podr√≠amos descargar todos los archivos de un BioProject de NCBI

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\#fastq{-}dump {-}{-}split{-}files SRR1234567}
\end{Highlighting}
\end{Shaded}

\section{Calcular contenido de GC}\label{calcular-contenido-de-gc}

Calcula el porcentaje de GC del gene nifH de \emph{Raoultella terrigena}. (Se suma la cantidad de G + C y se divide entre la longitud de la secuencia)

Descargar el archivo de genes del genoma representativo de \emph{Raoultella terrigena}

Algoritmo:

\begin{itemize}
\tightlist
\item
  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    Obtener el archivo de secuencias codificantes de \emph{R. terrigena}
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \setcounter{enumi}{1}
  \tightlist
  \item
    Obtener la secuencia del gene nifH
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \setcounter{enumi}{2}
  \tightlist
  \item
    Calcular la longitud de la secuencia
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \setcounter{enumi}{3}
  \tightlist
  \item
    Calcular el contenido de GC
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \setcounter{enumi}{4}
  \tightlist
  \item
    Calcular el porcentaje de GC del gene nifH
  \end{enumerate}
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Obtener el archivo de secuencias codificantes de \emph{R. terrigena}
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{wget} \AttributeTok{{-}O}\NormalTok{ Raoultella\_terrigena.cds.gz https://ftp.ncbi.nlm.nih.gov/genomes/refseq/bacteria/Raoultella\_terrigena/reference/GCF\_012029655.1\_ASM1202965v1/GCF\_012029655.1\_ASM1202965v1\_cds\_from\_genomic.fna.gz data/}
\end{Highlighting}
\end{Shaded}

No olvides descomprimir

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Obtener la secuencia del gene nifH
\end{enumerate}

2.1 identificar al gene de inter√©s

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{grep}\NormalTok{ nifH data/Raoultella\_terrigena.cds }
\end{Highlighting}
\end{Shaded}

2.2 Definir como obtendr√© la secuencia, hay varias formas, propongo una muy f√°cil, con \textbf{seqtk}.

Pero como no tenemos seqtk pues vamos a instalarlo \ldots{} Ve a la secci√≥n de instalci√≥n

2.2.1 Obtener el identificador de la secuencia sin caracteres especiales

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{grep}\NormalTok{ nifH data/Raoultella\_terrigena.cds }\KeywordTok{|} \FunctionTok{sed} \StringTok{\textquotesingle{}s/\textgreater{}//g\textquotesingle{}} \OperatorTok{\textgreater{}}\NormalTok{ results/nif\_headers.txt}
\end{Highlighting}
\end{Shaded}

2.2.2 Obtener la secuencia

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{seqtk}\NormalTok{ subseq data/Raoultella\_terrigena.cds results/nif\_headers.txt }\OperatorTok{\textgreater{}}\NormalTok{ results/nif.fasta}
\end{Highlighting}
\end{Shaded}

Ahora si, revisa el contenido del archivo que generamos

3.1 Calcular la longitud de la secuencia

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{grep} \AttributeTok{{-}v} \StringTok{\textquotesingle{}\textgreater{}\textquotesingle{}}\NormalTok{ results/nifH.fasta }\KeywordTok{|} \FunctionTok{tr} \AttributeTok{{-}d} \StringTok{\textquotesingle{}\textbackslash{}n\textquotesingle{}} \KeywordTok{|} \FunctionTok{wc} \AttributeTok{{-}c} \OperatorTok{\textgreater{}\textgreater{}}\NormalTok{ results/GC\_nifH.txt}
\end{Highlighting}
\end{Shaded}

3.2 Calcular el contenido de GC

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{grep} \AttributeTok{{-}v} \StringTok{\textquotesingle{}\textgreater{}\textquotesingle{}}\NormalTok{ results/nifH.fasta }\KeywordTok{|} \FunctionTok{tr} \AttributeTok{{-}d} \StringTok{\textquotesingle{}\textbackslash{}n\textquotesingle{}} \KeywordTok{|} \FunctionTok{tr} \PreprocessorTok{[}\SpecialStringTok{CG}\PreprocessorTok{]} \StringTok{\textquotesingle{}\textbackslash{}n\textquotesingle{}} \KeywordTok{|} \FunctionTok{wc}
\end{Highlighting}
\end{Shaded}

Comprobemos con el de AT

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{grep} \AttributeTok{{-}v} \StringTok{\textquotesingle{}\textgreater{}\textquotesingle{}}\NormalTok{ results/nifH.fasta }\KeywordTok{|} \FunctionTok{tr} \AttributeTok{{-}d} \StringTok{\textquotesingle{}\textbackslash{}n\textquotesingle{}} \KeywordTok{|} \FunctionTok{tr} \PreprocessorTok{[}\SpecialStringTok{AT}\PreprocessorTok{]} \StringTok{\textquotesingle{}\textbackslash{}n\textquotesingle{}} \KeywordTok{|} \FunctionTok{wc}
\end{Highlighting}
\end{Shaded}

\section{Isntalar ambientes conda}\label{isntalar-ambientes-conda}

Usaremos \textbf{conda} que es la herramienta m√°s com√∫n para la gesti√≥n de entornos de software y paquetes en bioinform√°tica.

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{conda}\NormalTok{ create }\AttributeTok{{-}{-}name}\NormalTok{ seqtk\_env seqtk }\AttributeTok{{-}c}\NormalTok{ bioconda }\AttributeTok{{-}y}
\end{Highlighting}
\end{Shaded}

\texttt{conda\ create}: Este comando inicia el proceso de creaci√≥n de un nuevo ambiente.

\texttt{-\/-name\ seqtk\_env}: Asigna el nombre seqtk\_env al nuevo ambiente. Se puede cambiar el nombre.

\texttt{seqtk}: Es el nombre del programa que queremos instalar. Conda buscar√° el paquete seqtk en sus canales.

\texttt{-c\ bioconda}: Le indica a Conda que busque el paquete en el canal de Bioconda, que es el repositorio principal para herramientas de bioinform√°tica.

\texttt{-y}: Responde ``s√≠'' autom√°ticamente a la pregunta de confirmaci√≥n, lo que hace que el proceso sea m√°s r√°pido y no interactivo.

\textbf{\texttt{seqtk}} es una herramienta de l√≠nea de comandos de prop√≥sito general para el procesamiento de secuencias en formato FASTA/Q. Fue desarrollado por Heng Li y es conocido por ser muy r√°pido y eficiente, lo que lo hace ideal para tareas como:

\begin{itemize}
\item
  Convertir archivos de FASTA a FASTQ y viceversa.
\item
  Muestrear (submuestrear) secuencias aleatoriamente.
\item
  Filtrar secuencias por longitud.
\end{itemize}

Es una herramienta fundamental en muchos flujos de trabajo de bioinform√°tica para la manipulaci√≥n de datos de secuenciaci√≥n de alto rendimiento.

\begin{itemize}
\tightlist
\item
  Una vez que el comando anterior termine de ejecutarse, el ambiente estar√° creado. Para empezar a usar \texttt{seqtk}, necesitas activar el ambiente:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{conda}\NormalTok{ activate seqtk\_env}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Cuando termines de usar seqtk, puedes desactivar el ambiente para volver a tu entorno base:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{conda}\NormalTok{ deactivate}
\end{Highlighting}
\end{Shaded}

\chapter{Recapitulaci√≥n}\label{recapitulaciuxf3n}

Accede a este formulario de google y responde las preguntas

\url{https://docs.google.com/forms/d/e/1FAIpQLSfAODGqJAMaTys2w5RmZg-KX3xWKG3t4d0ufhxlpIUya9C7nw/viewform?usp=sharing&ouid=111135442256323215026}

El archivo que necesitas para contestar se encuentra en el siguiente enlace:

\url{https://drive.google.com/file/d/1L3qymmU0bouCH3GjCEWcTS4lXp3sn0aX/view?usp=drive_link}

\chapter{En construcci√≥n tambi√©n}\label{en-construcciuxf3n-tambiuxe9n}

\end{document}
